<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Location Sender</title>
<script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#1e1f22;
  font-family:Segoe UI,sans-serif;
  color:white;
}
.card{
  background:#313338;
  padding:20px;
  width:420px;
  border-radius:14px;
  text-align:center;
}
.notice{
  background:#2b2d31;
  padding:12px;
  border-radius:10px;
  font-size:12px;
  color:#b5bac1;
  text-align:left;
  margin-bottom:10px;
  max-height:200px;
  overflow:auto;
}
.status{
  background:#2b2d31;
  padding:8px;
  border-radius:8px;
  font-size:12px;
  height:90px;
  overflow:auto;
  text-align:left;
}
button{
  background:#5865f2;
  border:none;
  color:white;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  margin-bottom:8px;
}
label{
  font-size:12px;
  display:block;
  margin-bottom:6px;
}
</style>
</head>
<body>

<div class="card">
  <h3>Send my location</h3>

  <div class="notice">
<b>Location Sharing and Privacy Notice</b><br><br>
This page allows you to voluntarily share your current geographical location with another user through a direct peer-to-peer connection. When you press the ‚ÄúSend location‚Äù button and grant your browser permission to access location services, your device will provide latitude, longitude, and an estimated accuracy value. The coordinates are reduced in precision before being transmitted in order to limit unnecessary detail and follow data-minimisation principles.<br><br>
Your location data is transmitted only for the purpose of delivering it to the recipient identified on this page (‚Äúipsharewithshooym‚Äù). The data is sent directly between peers using the PeerJS networking library and is not intentionally stored, logged, or retained by this page after transmission. This page does not build a profile about you, track your movement history, or reuse your location for analytics, advertising, or any secondary purpose.<br><br>
By checking the consent box and clicking the send button, you confirm that you understand that location data can be sensitive personal information and that the recipient may be able to infer your approximate real-world position. You may cancel or close this page at any time before sending to stop the sharing process. Location access is requested only once per button press and never in the background. Use of this tool is voluntary and intended for testing and personal communication purposes only.
  </div>

  <div style="font-size:12px;margin-bottom:6px;">
    Recipient: <b>ipsharewithshooym</b>
  </div>

  <label>
    <input type="checkbox" id="consent">
    I have read and agree to the notice above.
  </label>

  <button id="sendBtn">Send location</button>

  <div class="status" id="log"></div>
</div>

<script>
const HOST_ID = "ipsharewithshooym";

const logBox = document.getElementById("log");
const sendBtn = document.getElementById("sendBtn");
const consent = document.getElementById("consent");

let peer = null;
let conn = null;
let locationText = "";
let sent = false;

function log(t){
  const d = document.createElement("div");
  d.textContent = t;
  logBox.appendChild(d);
  logBox.scrollTop = logBox.scrollHeight;
}

function trySend(){
  if(!conn || !conn.open || !locationText || sent) return;

  const parts = locationText.split("|");

  const packet = {
    id: Date.now().toString(36) + Math.random().toString(36).slice(2),
    user: "LocationBot",
    msg:
`üìç Shared Location
Latitude: ${parts[0]}
Longitude: ${parts[1]}
Accuracy: ${parts[2]} m`,
    type: "text",
    senderId: peer.id,
    timestamp: Date.now()
  };

  conn.send(packet);
  sent = true;
  log("Location sent.");
}

sendBtn.onclick = () => {

  if(!window.isSecureContext){
    log("This page must be opened using HTTPS.");
    return;
  }

  if(!consent.checked){
    log("Please read the notice and give consent first.");
    return;
  }

  sent = false;
  locationText = "";

  log("Requesting location‚Ä¶");

  navigator.geolocation.getCurrentPosition(pos => {

    const lat = pos.coords.latitude.toFixed(4);
    const lon = pos.coords.longitude.toFixed(4);
    const acc = Math.round(pos.coords.accuracy);

    locationText = lat + "|" + lon + "|" + acc;

    log("Location ready.");

    peer = new Peer();

    peer.on("open", id => {
      log("Connected as " + id);

      conn = peer.connect(HOST_ID);

      conn.on("open", () => {
        log("Connected to recipient.");
        trySend();
      });

      conn.on("error", e => log("Connection error: " + e));
    });

  }, err => {
    log("Location error: " + err.message);
  });

};
</script>

</body>
</html>
